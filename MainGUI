import tkinter as tk
import sqlite3
from tkinter import ttk
from tkinter.messagebox import showinfo
import datetime
from PIL import Image, ImageTk
from SQLite import students
from NamesLists import president_names, officer_names, es_faculty_names, sb_faculty_names, as_faculty_names
from NamesLists import eh_faculty_names
from SQLiteQueries import president_main, faculty_main, officer_main

# Creating global variables initially to check later that the user has not voted for a position twice
globals()["presidential_votes"] = 0
globals()["faculty_votes"] = 0
globals()["officer_votes"] = 0

# Connecting to voting database
conn = sqlite3.connect("VotingDatabase3.db")
c = conn.cursor()


class MainWindow:

    def __init__(self, master):
        self.master = master

        # Setting the window up
        self.master.geometry("850x750")
        self.master.title("GSU ELECTIONS 2020")
        # self.master.configure()
        self.master.resizable(width=False, height=False)
        # set a Background
        self.load = Image.open("BCgreenwich.jpg")
        self.render = ImageTk.PhotoImage(self.load)
        self.main_label1 = tk.Label(image=self.render)
        self.main_label1.place(relx=0.5, rely=0.40, anchor="center")
        # set a University Logo
        self.logo = Image.open("UoGlogo.png")
        self.logorender = ImageTk.PhotoImage(self.logo)
        self.main_label2 = tk.Label(image=self.logorender, relief="sunken")
        self.main_label2.place(relx=0.5, rely=0.46, anchor="center")

        self.main_label = tk.Label(text="GSU Elections 2020", background="cornflowerblue", fg="white",
                                   font=("Georgia", "45", "bold", "italic"))
        self.main_label.place(relx=0.5, rely=0.30, anchor="center")

        self.vote_button = tk.Button(text="Vote", font=("Georgia", "12", "bold"), height="2", width=20,
                                     background="lightsteelblue", foreground="black", bd="4", relief="raised",
                                     command=self.vote)
        self.vote_button.place(relx=0.146, rely=0.75, anchor="sw")

        self.quit_button = tk.Button(text="Quit", font=("Georgia", "12", "bold"), height="2", width=20,
                                     background="lightsteelblue", foreground="black", bd="4", relief="raised",
                                     command=self.close_window)
        self.quit_button.place(relx=0.58, rely=0.75, anchor="sw")

    def vote(self):
        """
        Functionality for user when they press vote on main page
        """
        # Code below checks that voting is open in that specific days
        open_date = datetime.date.today()
        start_date = datetime.date(2019, 12, 7)
        end_date = datetime.date(2020, 1, 30)

        if start_date <= open_date <= end_date:
            self.new_window()
        else:
            showinfo("Alert Message", "Voting is now closed")

    def close_window(self):
        self.master.destroy()

    def new_window(self):
        self.list = root.place_slaves()
        for l in self.list:
            l.destroy()

        # next window
        self.second_window = SecondWindow(self.master)


class SecondWindow:

    def __init__(self, master):
        self.master = master

        # set a Background
        self.load = Image.open("BCgreenwich.jpg")
        self.render = ImageTk.PhotoImage(self.load)
        self.main_label1 = tk.Label(image=self.render)
        self.main_label1.place(relx=0.5, rely=0.40, anchor="center")
        # set a University Logo
        self.logo = Image.open("UoGlogo.png")
        self.logorender = ImageTk.PhotoImage(self.logo)
        self.main_label2 = tk.Label(image=self.logorender, relief="sunken")
        self.main_label2.place(relx=0.51, rely=0.14, anchor="center")
        # login text
        self.login_label = tk.Label(text="Log in with your University Username and Password", bg="cornflowerblue",
                                    fg="white", width="40", height=1, font=("Georgia", "18", "bold", "italic"))
        self.login_label.place(relx=0.50, rely=0.25, anchor="center")

        # Login buttons and Labels
        self.user_label = tk.Label(text="Username", width="15", height="1", bg="RoyalBlue4",
                                   fg="white", font=("Georgia", "10", "bold"))
        self.user_label.place(relx=0.42, rely=0.35, anchor="center")
        self.user_entry = tk.Entry(width="25", borderwidth="3", relief="sunken")
        self.user_entry.place(relx=0.71, rely=0.35, anchor="e")
        self.password_label = tk.Label(text="Password", width="15", height="1", bg="RoyalBlue4",
                                       fg="white", font=("Georgia", "10", "bold"))
        self.password_label.place(relx=0.42, rely=0.40, anchor="center")

        self.password_entry = tk.Entry(show="*", width="25", borderwidth="3", relief="sunken")
        self.password_entry.place(relx=0.71, rely=0.40, anchor="e")

        self.login_entry = tk.Button(text="LOG IN", font=("Gill Sans MT", "12", "bold"), height=1, width="18",
                                     command=self.check_user)
        self.login_entry.place(relx=0.60, rely=0.48, anchor="e")

        self.login_entry = tk.Button(text="EXIT", font=("Gill Sans MT", "12", "bold"), height=1, width="18",
                                     command=master.quit)
        self.login_entry.place(relx=0.60, rely=0.55, anchor="e")

    def check_user(self):
        self.valid_user = False
        self.has_voted = False
        self.password_attempt = self.password_entry.get()
        self.username_attempt = self.user_entry.get()

        for student in students:
            if student.username == self.username_attempt and student.password == self.password_attempt:
                # check that student is registered to vote or note
                if student.has_registered:
                    self.valid_user = True
                    self.new_window()
                    globals()["student_faculty"] = student.faculty
                    globals()["student_username"] = student.username
                else:
                    self.valid_user = True
                    showinfo("Window", "Sorry {}, you are not registered to vote. "
                                       "Please contact the GSU to request permission to vote".format(student.forename))
        if not self.valid_user:
            self.password_entry.delete(0, "end")
            self.user_entry.delete(0, "end")
            showinfo("Incorrect Details", "Incorrect password or username. Please try again.")

    def new_window(self):
        self.list = root.place_slaves()
        for l in self.list:
            l.destroy()

        # next window
        self.third_window = ThirdWindow(self.master)


class ThirdWindow:
    def __init__(self, master):
        self.master = master
        root.configure(background='MistyRose2')

        self.logo3 = Image.open("GSU-electionsLogo1.jpg")
        self.logorender3 = ImageTk.PhotoImage(self.logo3)
        self.main_label2 = tk.Label(image=self.logorender3)
        self.main_label2.place(relx=0.51, rely=0.38, anchor="center")

        self.choose_label = tk.Label(text="  Choose one of these three", bg="white",
                                     fg="black", width="40", height=1, font=("Georgia", "32", "bold", "italic"))
        self.choose_label.place(relx=0.5, rely=0.10, anchor="center")

        self.president_button = tk.Button(text="GSU President", font=("Gill Sans MT", "12", "bold"), height="3",
                                          width=20, command=self.vote_president)
        self.president_button.place(relx=0.5, rely=0.70, anchor="center")

        self.officer_button = tk.Button(text="GSU Officers", font=("Gill Sans MT", "12", "bold"), height="3", width=20,
                                        command=self.vote_officer)
        self.officer_button.place(relx=0.20, rely=0.70, anchor="center")

        self.faculty_button = tk.Button(text="GSU Faculty Officers", font=("Gill Sans MT", "12", "bold"), height="3",
                                        width=20, command=self.vote_faculty)
        self.faculty_button.place(relx=0.80, rely=0.70, anchor="center")

        self.back_button = tk.Button(text="Sign Out", font=("Gill Sans MT", "12", "bold"), height="1", width="20",
                                     command=self.go_back)
        self.back_button.place(relx=0.5, rely=0.90, anchor="center")

    def go_back(self):
        self.list = root.place_slaves()
        for l in self.list:
            l.destroy()

        self.signout_window = SignOutWindow(self.master)

    def vote_president(self):
        global presidential_votes

        if not presidential_votes:
            self.list = root.place_slaves()
            for l in self.list:
                l.destroy()
            # Next window class
            self.president_window = PresidentWindow(self.master)
        else:
            showinfo("window", "You cannot vote for this position again. Please try another position")

    def vote_officer(self):
        global officer_votes

        if not officer_votes:
            self.list = root.place_slaves()
            for l in self.list:
                l.destroy()
            self.officer_window = OfficerWindow(self.master)
        else:
            showinfo("window", "You cannot vote for this position again. Please try another position")

    def vote_faculty(self):
        global faculty_votes

        if not faculty_votes:
            self.list = root.place_slaves()
            for l in self.list:
                l.destroy()

            # Code checks what faculty the user is in and then takes them to the correct page
            global student_faculty
            if student_faculty == "EH":
                self.eh_faculty__window = FacultyWindowEH(self.master)
            elif student_faculty == "ES":
                self.es_faculty_window = FacultyWindowES(self.master)
            elif student_faculty == "AS":
                self.as_faculty_window = FacultyWindowAS(self.master)
            elif student_faculty == "SB":
                self.sb_faculty_window = FacultyWindowSB(self.master)
        else:
            showinfo("window", "You cannot vote for this position again. Please try another position")


class SignOutWindow:

    def __init__(self, master):
        self.master = master

        self.thank_you = tk.Label(text="Thank you!", bg="white",
                                     fg="black", width="40", height=1, font=("Georgia", "32", "bold", "italic"))
        self.thank_you.place(relx=0.5, rely=0.10, anchor="center")
        self.label = tk.Label(text="For entering the GSU Voting System",
                              bg="white",
                              fg="black", width="40", height=1, font=("Georgia", "32", "bold", "italic"))
        self.label.place(relx=0.5, rely=0.17, anchor="center")
        self.info_label = tk.Label(text="If you are another student who would like to vote,",
                                   bg="white",
                                   fg="black", width="50", height="1",
                                   font=("Georgia", "20", "bold", "italic"))
        self.info_label.place(relx=0.5, rely=0.44, anchor="center")
        self.info_label_two = tk.Label(text="please close this program and login again to vote correctly.",
                                       bg="white",
                                       fg="black", width="50", height="1",
                                       font=("Georgia", "20", "bold", "italic"))
        self.info_label_two.place(relx=0.5, rely=0.485, anchor="center")
        self.quit_button = tk.Button(text="Quit", font=("Gill Sans MT", "12", "bold"), height="2", width=15, command=self.close_window)
        self.quit_button.place(relx=0.5, rely=0.65, anchor="center")
        # logo GSU
        self.logo4 = Image.open("logogsu.png")
        self.logorender4 = ImageTk.PhotoImage(self.logo4)
        self.main_label2 = tk.Label(image=self.logorender4)
        self.main_label2.place(relx=0.85, rely=0.90, anchor="center")

    def close_window(self):
        self.master.destroy()


class PresidentWindow:

    def __init__(self, master):
        self.master = master

        # Main Headers
        self.president_label = tk.Label(text="GSU President", bg="white",
                                        fg="black", width="40", height="1", font=("Georgia", "32", "bold", "italic"))
        self.president_label.place(relx=0.5, rely=0.10, anchor="center")

        self.president_two_label = tk.Label(text="Please rank each candidate in order of preference", bg="white",
                                            fg="black", width="40", height="1",
                                            font=("Georgia", "22", "bold", "italic"))
        self.president_two_label.place(relx=0.5, rely=0.2, anchor="center")

        # Logo candidate
        self.logoGUI = Image.open("userLogo2.png")
        self.logorender1 = ImageTk.PhotoImage(self.logoGUI)
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.15, rely=0.35, anchor="center")
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.375, rely=0.35, anchor="center")
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.625, rely=0.35, anchor="center")
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.848, rely=0.35, anchor="center")

        # All combo boxes
        self.first_box = ttk.Combobox(values=president_names, state="readonly")
        self.first_box.place(relx=0.15, rely=0.55, anchor="center")
        self.second_box = ttk.Combobox(values=president_names, state="readonly")
        self.second_box.place(relx=0.375, rely=0.55, anchor="center")
        self.third_box = ttk.Combobox(values=president_names, state="readonly")
        self.third_box.place(relx=0.625, rely=0.55, anchor="center")
        self.fourth_box = ttk.Combobox(values=president_names, state="readonly")
        self.fourth_box.place(relx=0.85, rely=0.55, anchor="center")

        # Preference labels
        self.first_label = tk.Label(text="1st Preference", bg="RoyalBlue4", width="12",
                                    height="2", fg="white", font=("Georgia", "12", "bold"))
        self.first_label.place(relx=0.15, rely=0.50, anchor="center")
        self.second_label = tk.Label(text="2nd Preference", bg="RoyalBlue4", width="12",
                                     height="2", fg="white", font=("Georgia", "12", "bold"))
        self.second_label.place(relx=0.375, rely=0.50, anchor="center")
        self.third_label = tk.Label(text="3rd Preference", bg="RoyalBlue4", width="12",
                                    height="2", fg="white", font=("Georgia", "12", "bold"))
        self.third_label.place(relx=0.625, rely=0.50, anchor="center")
        self.fourth_label = tk.Label(text="4th Preference", bg="RoyalBlue4", width="12",
                                     height="2", fg="white", font=("Georgia", "12", "bold"))
        self.fourth_label.place(relx=0.85, rely=0.50, anchor="center")

        # Buttons
        self.save_choice = tk.Button(text="Save Choice", font=("Gill Sans MT", "12", "bold"), height="2", width=15,
                                     command=self.save_choice)
        self.save_choice.place(relx=0.5, rely=0.75, anchor="center")
        self.back_button = tk.Button(text="Back", font=("Gill Sans MT", "12", "bold"), height="2", width=15,
                                     command=self.go_back)
        self.back_button.place(relx=0.15, rely=0.90, anchor="center")

        # logo GSU
        self.logo4 = Image.open("logogsu.png")
        self.logorender4 = ImageTk.PhotoImage(self.logo4)
        self.main_label2 = tk.Label(image=self.logorender4)
        self.main_label2.place(relx=0.85, rely=0.90, anchor="center")

    def save_choice(self):
        global student_username
        self.first_choice = self.first_box.get()
        self.second_choice = self.second_box.get()
        self.third_choice = self.third_box.get()
        self.fourth_choice = self.fourth_box.get()
        globals()["presidential_votes"] = 0

        # if user has voted for all four preferences correctly without errors then save entry and continue
        if (self.first_box.get() in president_names and self.second_box.get() in president_names and
                self.third_box.get() in president_names and self.fourth_box.get() in president_names):
            if (self.first_box.get() != self.second_box.get() and self.first_box.get() != self.third_box.get() and
                    self.first_box.get() != self.fourth_box.get() and self.second_box.get() != self.third_box.get() and
                    self.second_box.get() != self.fourth_box.get() and self.third_box.get() != self.fourth_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["presidential_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    president_main(username=student_username, first_pref=self.first_choice,
                                   second_pref=self.second_choice, third_pref=self.third_choice,
                                   fourth_pref=self.fourth_choice)
                    self.go_back()

            # If user selects the same candidate twice
            elif (self.first_box.get() == self.second_box.get() or self.first_box.get() == self.third_box.get() or
                  self.first_box.get() == self.fourth_box.get() or self.second_box.get() == self.third_box.get() or
                  self.second_box.get() == self.fourth_box.get() or self.third_box.get() == self.fourth_box.get()):
                showinfo("window", "You cannot select the same candidate twice. Please try again")

        # if user only votes for first preference
        elif (self.first_box.get() in president_names and self.second_box.get() == "" and self.third_box.get() == ""
              and self.fourth_box.get() == ""):
            self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choice")
            if self.msgbox == "yes":
                globals()["presidential_votes"] = 1
                president_main(username=student_username, first_pref=self.first_choice)
                self.go_back()

        # if user votes for 1st and 2nd preference but not 3rd or 4th
        elif (self.first_box.get() in president_names and self.second_box.get() in president_names and
              self.third_box.get() == "" and self.fourth_box.get() == ""):
            if self.first_box.get() != self.second_box.get():
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["presidential_votes"] = 1
                    president_main(username=student_username, first_pref=self.first_choice,
                                   second_pref=self.second_choice)
                    self.go_back()

            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st and 3rd but not 2nd or 4th
        elif (self.first_box.get() in president_names and self.second_box.get() == "" and
              self.third_box.get() in president_names and self.fourth_box.get() == ""):
            if self.first_box.get() != self.third_box.get():
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["presidential_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    president_main(username=student_username, first_pref=self.first_choice,
                                   third_pref=self.third_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st and 4th but not 2nd or 3rd
        elif (self.first_box.get() in president_names and self.second_box.get() == "" and
              self.third_box.get() == "" and self.fourth_box.get() in president_names):
            if self.first_box.get() != self.fourth_box.get():
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["presidential_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    president_main(username=student_username, first_pref=self.first_choice,
                                   fourth_pref=self.fourth_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st, 3rd and 4th but not 2nd
        elif (self.first_box.get() in president_names and self.second_box.get() == "" and
              self.third_box.get() in president_names and self.fourth_box.get() in president_names):
            if (self.first_box.get() != self.fourth_box.get() and self.first_box.get() != self.third_box.get() and
                    self.third_box.get() != self.fourth_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["presidential_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    president_main(username=student_username, first_pref=self.first_choice,
                                   third_pref=self.third_choice, fourth_pref=self.fourth_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st, 2nd and 4th but not 3rd
        elif (self.first_box.get() in president_names and self.second_box.get() in president_names and
              self.third_box.get() == "" and self.fourth_box.get() in president_names):
            if (self.first_box.get() != self.second_box.get() and self.first_box.get() != self.fourth_box.get() and
                    self.second_box.get() != self.fourth_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["presidential_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    president_main(username=student_username, first_pref=self.first_choice,
                                   second_pref=self.second_choice, fourth_pref=self.fourth_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st, 2nd and 3rd but not 4th
        elif (self.first_box.get() in president_names and self.second_box.get() in president_names and
              self.third_box.get() in president_names and self.fourth_box.get() == ""):
            if (self.first_box.get() != self.second_box.get() and self.first_box.get() != self.third_box.get() and
                    self.second_box.get() != self.third_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["presidential_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    president_main(username=student_username, first_pref=self.first_choice,
                                   second_pref=self.second_choice, third_pref=self.third_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # Incorrect voting
        else:
            showinfo("Incorrect Input", "You have voted incorrectly please try again")

    def go_back(self):
        self.list = root.place_slaves()
        for l in self.list:
            l.destroy()

        self.third_window = ThirdWindow(self.master)


class FacultyWindowEH:

    def __init__(self, master):
        self.master = master

        # Main Headers
        self.faculty_label = tk.Label(text="GSU Faculty Officers", bg="white",
                                      fg="black", width="40", height="1", font=("Georgia", "32", "bold", "italic"))
        self.faculty_label.place(relx=0.5, rely=0.10, anchor="center")

        self.faculty_two_label = tk.Label(text="Please rank each candidate in order of preference",
                                          bg="white",
                                          fg="black", width="40", height="1", font=("Georgia", "22", "bold", "italic"))
        self.faculty_two_label.place(relx=0.5, rely=0.2, anchor="center")

        self.unique_label = tk.Label(text="Faculty of Education, ", bg="white",
                                     width="30", height="1", fg="black", font=("Georgia", "14", "bold"))
        self.unique_label.place(relx=0.488, rely=0.88, anchor="center")
        self.unique_label = tk.Label(text="Health and Human Sciences", bg="white",
                                     width="30", height="1", fg="black", font=("Georgia", "14", "bold"))
        self.unique_label.place(relx=0.488, rely=0.915, anchor="center")

        # Logo candidate
        self.logoGUI = Image.open("userLogo2.png")
        self.logorender1 = ImageTk.PhotoImage(self.logoGUI)
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.15, rely=0.35, anchor="center")
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.375, rely=0.35, anchor="center")
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.625, rely=0.35, anchor="center")
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.848, rely=0.35, anchor="center")

        # All combo boxes
        self.first_box = ttk.Combobox(values=eh_faculty_names, state="readonly")
        self.first_box.place(relx=0.15, rely=0.55, anchor="center")
        self.second_box = ttk.Combobox(values=eh_faculty_names, state="readonly")
        self.second_box.place(relx=0.375, rely=0.55, anchor="center")
        self.third_box = ttk.Combobox(values=eh_faculty_names, state="readonly")
        self.third_box.place(relx=0.625, rely=0.55, anchor="center")
        self.fourth_box = ttk.Combobox(values=eh_faculty_names, state="readonly")
        self.fourth_box.place(relx=0.85, rely=0.55, anchor="center")

        # Preference labels
        self.first_label = tk.Label(text="1st Preference", bg="RoyalBlue4", width="12",
                                    height="2", fg="white", font=("Georgia", "12", "bold"))
        self.first_label.place(relx=0.15, rely=0.50, anchor="center")
        self.second_label = tk.Label(text="2nd Preference", bg="RoyalBlue4", width="12",
                                     height="2", fg="white", font=("Georgia", "12", "bold"))
        self.second_label.place(relx=0.375, rely=0.50, anchor="center")
        self.third_label = tk.Label(text="3rd Preference", bg="RoyalBlue4", width="12",
                                    height="2", fg="white", font=("Georgia", "12", "bold"))
        self.third_label.place(relx=0.625, rely=0.50, anchor="center")
        self.fourth_label = tk.Label(text="4th Preference", bg="RoyalBlue4", width="12",
                                     height="2", fg="white", font=("Georgia", "12", "bold"))
        self.fourth_label.place(relx=0.85, rely=0.50, anchor="center")

        # Buttons
        self.save_choice = tk.Button(text="Save Choice", font=("Gill Sans MT", "12", "bold"), height="2", width="15",
                                     command=self.save_choice)
        self.save_choice.place(relx=0.5, rely=0.75, anchor="center")
        self.back_button = tk.Button(text="Back", font=("Gill Sans MT", "12", "bold"), height="2", width="15",
                                     command=self.go_back)
        self.back_button.place(relx=0.15, rely=0.90, anchor="center")

        # logo GSU
        self.logo4 = Image.open("logogsu.png")
        self.logorender4 = ImageTk.PhotoImage(self.logo4)
        self.main_label2 = tk.Label(image=self.logorender4)
        self.main_label2.place(relx=0.85, rely=0.90, anchor="center")

    def save_choice(self):
        global student_username
        self.first_choice = self.first_box.get()
        self.second_choice = self.second_box.get()
        self.third_choice = self.third_box.get()
        self.fourth_choice = self.fourth_box.get()
        globals()["faculty_votes"] = 0

        # if user has voted for all four preferences correctly without errors then save entry and continue
        if (self.first_box.get() in eh_faculty_names and self.second_box.get() in eh_faculty_names and
                self.third_box.get() in eh_faculty_names and self.fourth_box.get() in eh_faculty_names):
            if (self.first_box.get() != self.second_box.get() and self.first_box.get() != self.third_box.get() and
                    self.first_box.get() != self.fourth_box.get() and self.second_box.get() != self.third_box.get() and
                    self.second_box.get() != self.fourth_box.get() and self.third_box.get() != self.fourth_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="EH", username=student_username, first_pref=self.first_choice,
                                 second_pref=self.second_choice, third_pref=self.third_choice,
                                 fourth_pref=self.fourth_choice)
                    self.go_back()

            # If user selects the same candidate twice
            elif (self.first_box.get() == self.second_box.get() or self.first_box.get() == self.third_box.get() or
                  self.first_box.get() == self.fourth_box.get() or self.second_box.get() == self.third_box.get() or
                  self.second_box.get() == self.fourth_box.get() or self.third_box.get() == self.fourth_box.get()):
                showinfo("window", "You cannot select the same candidate twice. Please try again")

        # if user only votes for first preference
        elif (self.first_box.get() in eh_faculty_names and self.second_box.get() == "" and self.third_box.get() == ""
              and self.fourth_box.get() == ""):
            self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choice")
            if self.msgbox == "yes":
                globals()["faculty_votes"] = 1
                faculty_main(faculty="EH", username=student_username, first_pref=self.first_choice)
                self.go_back()

        # if user votes for 1st and 2nd preference but not 3rd or 4th
        elif (self.first_box.get() in eh_faculty_names and self.second_box.get() in eh_faculty_names and
              self.third_box.get() == "" and self.fourth_box.get() == ""):
            if self.first_box.get() != self.second_box.get():
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    self.go_back()
                    faculty_main(faculty="EH", username=student_username, first_pref=self.first_choice,
                                 second_pref=self.second_choice)
                    self.go_back()

            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st and 3rd but not 2nd or 4th
        elif (self.first_box.get() in eh_faculty_names and self.second_box.get() == "" and
              self.third_box.get() in eh_faculty_names and self.fourth_box.get() == ""):
            if self.first_box.get() != self.third_box.get():
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="EH", username=student_username, first_pref=self.first_choice,
                                 third_pref=self.third_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st and 4th but not 2nd or 3rd
        elif (self.first_box.get() in eh_faculty_names and self.second_box.get() == "" and
              self.third_box.get() == "" and self.fourth_box.get() in eh_faculty_names):
            if self.first_box.get() != self.fourth_box.get():
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="EH", username=student_username, first_pref=self.first_choice,
                                 fourth_pref=self.fourth_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st, 3rd and 4th but not 2nd
        elif (self.first_box.get() in eh_faculty_names and self.second_box.get() == "" and
              self.third_box.get() in eh_faculty_names and self.fourth_box.get() in eh_faculty_names):
            if (self.first_box.get() != self.fourth_box.get() and self.first_box.get() != self.third_box.get() and
                    self.third_box.get() != self.fourth_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="EH", username=student_username, first_pref=self.first_choice,
                                 third_pref=self.third_choice, fourth_pref=self.fourth_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st, 2nd and 4th but not 3rd
        elif (self.first_box.get() in eh_faculty_names and self.second_box.get() in eh_faculty_names and
              self.third_box.get() == "" and self.fourth_box.get() in eh_faculty_names):
            if (self.first_box.get() != self.second_box.get() and self.first_box.get() != self.fourth_box.get() and
                    self.second_box.get() != self.fourth_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="EH", username=student_username, first_pref=self.first_choice,
                                 second_pref=self.second_choice, fourth_pref=self.fourth_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st, 2nd and 3rd but not 4th
        elif (self.first_box.get() in eh_faculty_names and self.second_box.get() in eh_faculty_names and
              self.third_box.get() in eh_faculty_names and self.fourth_box.get() == ""):
            if (self.first_box.get() != self.second_box.get() and self.first_box.get() != self.third_box.get() and
                    self.second_box.get() != self.third_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="EH", username=student_username, first_pref=self.first_choice,
                                 second_pref=self.second_choice, third_pref=self.third_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # Incorrect voting
        else:
            showinfo("Incorrect Input", "You have voted incorrectly please try again")

    def go_back(self):
        self.list = root.place_slaves()
        for l in self.list:
            l.destroy()
        self.third_window = ThirdWindow(self.master)


class FacultyWindowES:

    def __init__(self, master):
        self.master = master

        # Main Headers
        self.faculty_label = tk.Label(text="GSU Faculty Officers", bg="white",
                                      fg="black", width="40", height="1", font=("Georgia", "32", "bold", "italic"))
        self.faculty_label.place(relx=0.5, rely=0.10, anchor="center")

        self.faculty_two_label = tk.Label(text="Please rank each candidate in order of preference",
                                          bg="white",
                                          fg="black", width="40", height="1", font=("Georgia", "22", "bold", "italic"))
        self.faculty_two_label.place(relx=0.5, rely=0.2, anchor="center")

        self.unique_label = tk.Label(text="Faculty of Engineering and Science", bg="white",
                                     width="28", height="1", fg="black", font=("Georgia", "15", "bold"))
        self.unique_label.place(relx=0.488, rely=0.88, anchor="center")

        # Logo candidate
        self.logoGUI = Image.open("userLogo2.png")
        self.logorender1 = ImageTk.PhotoImage(self.logoGUI)
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.15, rely=0.35, anchor="center")
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.375, rely=0.35, anchor="center")
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.625, rely=0.35, anchor="center")
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.848, rely=0.35, anchor="center")

        # All combo boxes
        self.first_box = ttk.Combobox(values=es_faculty_names, state="readonly")
        self.first_box.place(relx=0.15, rely=0.55, anchor="center")
        self.second_box = ttk.Combobox(values=es_faculty_names, state="readonly")
        self.second_box.place(relx=0.375, rely=0.55, anchor="center")
        self.third_box = ttk.Combobox(values=es_faculty_names, state="readonly")
        self.third_box.place(relx=0.625, rely=0.55, anchor="center")
        self.fourth_box = ttk.Combobox(values=es_faculty_names, state="readonly")
        self.fourth_box.place(relx=0.85, rely=0.55, anchor="center")

        # Preference labels
        self.first_label = tk.Label(text="1st Preference", bg="RoyalBlue4", width="12",
                                    height="2", fg="white", font=("Georgia", "12", "bold"))
        self.first_label.place(relx=0.15, rely=0.50, anchor="center")
        self.second_label = tk.Label(text="2nd Preference", bg="RoyalBlue4", width="12",
                                     height="2", fg="white", font=("Georgia", "12", "bold"))
        self.second_label.place(relx=0.375, rely=0.50, anchor="center")
        self.third_label = tk.Label(text="3rd Preference", bg="RoyalBlue4", width="12",
                                    height="2", fg="white", font=("Georgia", "12", "bold"))
        self.third_label.place(relx=0.625, rely=0.50, anchor="center")
        self.fourth_label = tk.Label(text="4th Preference", bg="RoyalBlue4", width="12",
                                     height="2", fg="white", font=("Georgia", "12", "bold"))
        self.fourth_label.place(relx=0.85, rely=0.50, anchor="center")

        # Buttons
        self.save_choice = tk.Button(text="Save Choice", font=("Gill Sans MT", "12", "bold"), height="2", width="15",
                                     command=self.save_choice)
        self.save_choice.place(relx=0.5, rely=0.75, anchor="center")
        self.back_button = tk.Button(text="Back", font=("Gill Sans MT", "12", "bold"), height="2", width="15",
                                     command=self.go_back)
        self.back_button.place(relx=0.15, rely=0.90, anchor="center")
        # logo GSU
        self.logo4 = Image.open("logogsu.png")
        self.logorender4 = ImageTk.PhotoImage(self.logo4)
        self.main_label2 = tk.Label(image=self.logorender4)
        self.main_label2.place(relx=0.85, rely=0.90, anchor="center")

    def save_choice(self):
        global student_username
        self.first_choice = self.first_box.get()
        self.second_choice = self.second_box.get()
        self.third_choice = self.third_box.get()
        self.fourth_choice = self.fourth_box.get()
        globals()["faculty_votes"] = 0

        # if user has voted for all four preferences correctly without errors then save entry and continue
        if (self.first_box.get() in es_faculty_names and self.second_box.get() in es_faculty_names and
                self.third_box.get() in es_faculty_names and self.fourth_box.get() in es_faculty_names):
            if (self.first_box.get() != self.second_box.get() and self.first_box.get() != self.third_box.get() and
                    self.first_box.get() != self.fourth_box.get() and self.second_box.get() != self.third_box.get() and
                    self.second_box.get() != self.fourth_box.get() and self.third_box.get() != self.fourth_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="ES", username=student_username, first_pref=self.first_choice,
                                 second_pref=self.second_choice, third_pref=self.third_choice,
                                 fourth_pref=self.fourth_choice)
                    self.go_back()

            # If user selects the same candidate twice
            elif (self.first_box.get() == self.second_box.get() or self.first_box.get() == self.third_box.get() or
                  self.first_box.get() == self.fourth_box.get() or self.second_box.get() == self.third_box.get() or
                  self.second_box.get() == self.fourth_box.get() or self.third_box.get() == self.fourth_box.get()):
                showinfo("window", "You cannot select the same candidate twice. Please try again")

        # if user only votes for first preference
        elif (self.first_box.get() in es_faculty_names and self.second_box.get() == "" and self.third_box.get() == ""
              and self.fourth_box.get() == ""):
            self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choice")
            if self.msgbox == "yes":
                globals()["faculty_votes"] = 1
                faculty_main(faculty="ES", username=student_username, first_pref=self.first_choice)
                self.go_back()

        # if user votes for 1st and 2nd preference but not 3rd or 4th
        elif (self.first_box.get() in es_faculty_names and self.second_box.get() in es_faculty_names and
              self.third_box.get() == "" and self.fourth_box.get() == ""):
            if self.first_box.get() != self.second_box.get():
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    self.go_back()
                    faculty_main(faculty="ES", username=student_username, first_pref=self.first_choice,
                                 second_pref=self.second_choice)
                    self.go_back()

            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st and 3rd but not 2nd or 4th
        elif (self.first_box.get() in es_faculty_names and self.second_box.get() == "" and
              self.third_box.get() in es_faculty_names and self.fourth_box.get() == ""):
            if self.first_box.get() != self.third_box.get():
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="ES", username=student_username, first_pref=self.first_choice,
                                 third_pref=self.third_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st and 4th but not 2nd or 3rd
        elif (self.first_box.get() in es_faculty_names and self.second_box.get() == "" and
              self.third_box.get() == "" and self.fourth_box.get() in es_faculty_names):
            if self.first_box.get() != self.fourth_box.get():
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="ES", username=student_username, first_pref=self.first_choice,
                                 fourth_pref=self.fourth_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st, 3rd and 4th but not 2nd
        elif (self.first_box.get() in es_faculty_names and self.second_box.get() == "" and
              self.third_box.get() in es_faculty_names and self.fourth_box.get() in es_faculty_names):
            if (self.first_box.get() != self.fourth_box.get() and self.first_box.get() != self.third_box.get() and
                    self.third_box.get() != self.fourth_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="ES", username=student_username, first_pref=self.first_choice,
                                 third_pref=self.third_choice, fourth_pref=self.fourth_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st, 2nd and 4th but not 3rd
        elif (self.first_box.get() in es_faculty_names and self.second_box.get() in es_faculty_names and
              self.third_box.get() == "" and self.fourth_box.get() in es_faculty_names):
            if (self.first_box.get() != self.second_box.get() and self.first_box.get() != self.fourth_box.get() and
                    self.second_box.get() != self.fourth_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="ES", username=student_username, first_pref=self.first_choice,
                                 second_pref=self.second_choice, fourth_pref=self.fourth_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st, 2nd and 3rd but not 4th
        elif (self.first_box.get() in es_faculty_names and self.second_box.get() in es_faculty_names and
              self.third_box.get() in es_faculty_names and self.fourth_box.get() == ""):
            if (self.first_box.get() != self.second_box.get() and self.first_box.get() != self.third_box.get() and
                    self.second_box.get() != self.third_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="ES", username=student_username, first_pref=self.first_choice,
                                 second_pref=self.second_choice, third_pref=self.third_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # Incorrect voting
        else:
            showinfo("Incorrect Input", "You have voted incorrectly please try again")

    def go_back(self):
        self.list = root.place_slaves()
        for l in self.list:
            l.destroy()
        self.third_window = ThirdWindow(self.master)


class FacultyWindowAS:

    def __init__(self, master):
        self.master = master

        # Main Headers
        self.faculty_label = tk.Label(text="GSU Faculty Officers", bg="white",
                                      fg="black", width="40", height="1", font=("Georgia", "32", "bold", "italic"))
        self.faculty_label.place(relx=0.5, rely=0.10, anchor="center")

        self.faculty_two_label = tk.Label(text="Please rank each candidate in order of preference",
                                          bg="white",
                                          fg="black", width="40", height="1", font=("Georgia", "22", "bold", "italic"))
        self.faculty_two_label.place(relx=0.5, rely=0.2, anchor="center")

        self.unique_label = tk.Label(text="Faculty of Liberal Arts and Sciences", bg="white",
                                     width="30", height="1", fg="black", font=("Georgia", "14", "bold"))
        self.unique_label.place(relx=0.488, rely=0.88, anchor="center")

        # Logo candidate
        self.logoGUI = Image.open("userLogo2.png")
        self.logorender1 = ImageTk.PhotoImage(self.logoGUI)
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.15, rely=0.35, anchor="center")
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.375, rely=0.35, anchor="center")
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.625, rely=0.35, anchor="center")
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.848, rely=0.35, anchor="center")

        # All combo boxes
        self.first_box = ttk.Combobox(values=as_faculty_names, state="readonly")
        self.first_box.place(relx=0.15, rely=0.55, anchor="center")
        self.second_box = ttk.Combobox(values=as_faculty_names, state="readonly")
        self.second_box.place(relx=0.375, rely=0.55, anchor="center")
        self.third_box = ttk.Combobox(values=as_faculty_names, state="readonly")
        self.third_box.place(relx=0.625, rely=0.55, anchor="center")
        self.fourth_box = ttk.Combobox(values=as_faculty_names, state="readonly")
        self.fourth_box.place(relx=0.85, rely=0.55, anchor="center")

        # Preference labels
        self.first_label = tk.Label(text="1st Preference", bg="RoyalBlue4", width="12",
                                    height="2", fg="white", font=("Georgia", "12", "bold"))
        self.first_label.place(relx=0.15, rely=0.50, anchor="center")
        self.second_label = tk.Label(text="2nd Preference", bg="RoyalBlue4", width="12",
                                     height="2", fg="white", font=("Georgia", "12", "bold"))
        self.second_label.place(relx=0.375, rely=0.50, anchor="center")
        self.third_label = tk.Label(text="3rd Preference", bg="RoyalBlue4", width="12",
                                    height="2", fg="white", font=("Georgia", "12", "bold"))
        self.third_label.place(relx=0.625, rely=0.50, anchor="center")
        self.fourth_label = tk.Label(text="4th Preference", bg="RoyalBlue4", width="12",
                                     height="2", fg="white", font=("Georgia", "12", "bold"))
        self.fourth_label.place(relx=0.85, rely=0.50, anchor="center")

        # Buttons
        self.save_choice = tk.Button(text="Save Choice", font=("Gill Sans MT", "12", "bold"), height="2", width="15",
                                     command=self.save_choice)
        self.save_choice.place(relx=0.5, rely=0.75, anchor="center")
        self.back_button = tk.Button(text="Back", font=("Gill Sans MT", "12", "bold"), height="2", width="15",
                                     command=self.go_back)
        self.back_button.place(relx=0.15, rely=0.90, anchor="center")

        # logo GSU
        self.logo4 = Image.open("logogsu.png")
        self.logorender4 = ImageTk.PhotoImage(self.logo4)
        self.main_label2 = tk.Label(image=self.logorender4)
        self.main_label2.place(relx=0.85, rely=0.90, anchor="center")

    def save_choice(self):
        global student_username
        self.first_choice = self.first_box.get()
        self.second_choice = self.second_box.get()
        self.third_choice = self.third_box.get()
        self.fourth_choice = self.fourth_box.get()
        globals()["faculty_votes"] = 0

        # if user has voted for all four preferences correctly without errors then save entry and continue
        if (self.first_box.get() in as_faculty_names and self.second_box.get() in as_faculty_names and
                self.third_box.get() in as_faculty_names and self.fourth_box.get() in as_faculty_names):
            if (self.first_box.get() != self.second_box.get() and self.first_box.get() != self.third_box.get() and
                    self.first_box.get() != self.fourth_box.get() and self.second_box.get() != self.third_box.get() and
                    self.second_box.get() != self.fourth_box.get() and self.third_box.get() != self.fourth_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="AS", username=student_username, first_pref=self.first_choice,
                                 second_pref=self.second_choice, third_pref=self.third_choice,
                                 fourth_pref=self.fourth_choice)
                    self.go_back()

            # If user selects the same candidate twice
            elif (self.first_box.get() == self.second_box.get() or self.first_box.get() == self.third_box.get() or
                  self.first_box.get() == self.fourth_box.get() or self.second_box.get() == self.third_box.get() or
                  self.second_box.get() == self.fourth_box.get() or self.third_box.get() == self.fourth_box.get()):
                showinfo("window", "You cannot select the same candidate twice. Please try again")

        # if user only votes for first preference
        elif (self.first_box.get() in as_faculty_names and self.second_box.get() == "" and self.third_box.get() == ""
              and self.fourth_box.get() == ""):
            self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choice")
            if self.msgbox == "yes":
                globals()["faculty_votes"] = 1
                faculty_main(faculty="AS", username=student_username, first_pref=self.first_choice)
                self.go_back()

        # if user votes for 1st and 2nd preference but not 3rd or 4th
        elif (self.first_box.get() in as_faculty_names and self.second_box.get() in as_faculty_names and
              self.third_box.get() == "" and self.fourth_box.get() == ""):
            if self.first_box.get() != self.second_box.get():
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    self.go_back()
                    faculty_main(faculty="AS", username=student_username, first_pref=self.first_choice,
                                 second_pref=self.second_choice)
                    self.go_back()

            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st and 3rd but not 2nd or 4th
        elif (self.first_box.get() in as_faculty_names and self.second_box.get() == "" and
              self.third_box.get() in as_faculty_names and self.fourth_box.get() == ""):
            if self.first_box.get() != self.third_box.get():
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="AS", username=student_username, first_pref=self.first_choice,
                                 third_pref=self.third_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st and 4th but not 2nd or 3rd
        elif (self.first_box.get() in as_faculty_names and self.second_box.get() == "" and
              self.third_box.get() == "" and self.fourth_box.get() in as_faculty_names):
            if self.first_box.get() != self.fourth_box.get():
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="AS", username=student_username, first_pref=self.first_choice,
                                 fourth_pref=self.fourth_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st, 3rd and 4th but not 2nd
        elif (self.first_box.get() in as_faculty_names and self.second_box.get() == "" and
              self.third_box.get() in as_faculty_names and self.fourth_box.get() in as_faculty_names):
            if (self.first_box.get() != self.fourth_box.get() and self.first_box.get() != self.third_box.get() and
                    self.third_box.get() != self.fourth_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="AS", username=student_username, first_pref=self.first_choice,
                                 third_pref=self.third_choice, fourth_pref=self.fourth_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st, 2nd and 4th but not 3rd
        elif (self.first_box.get() in as_faculty_names and self.second_box.get() in as_faculty_names and
              self.third_box.get() == "" and self.fourth_box.get() in as_faculty_names):
            if (self.first_box.get() != self.second_box.get() and self.first_box.get() != self.fourth_box.get() and
                    self.second_box.get() != self.fourth_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="AS", username=student_username, first_pref=self.first_choice,
                                 second_pref=self.second_choice, fourth_pref=self.fourth_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st, 2nd and 3rd but not 4th
        elif (self.first_box.get() in as_faculty_names and self.second_box.get() in as_faculty_names and
              self.third_box.get() in as_faculty_names and self.fourth_box.get() == ""):
            if (self.first_box.get() != self.second_box.get() and self.first_box.get() != self.third_box.get() and
                    self.second_box.get() != self.third_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="AS", username=student_username, first_pref=self.first_choice,
                                 second_pref=self.second_choice, third_pref=self.third_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # Incorrect voting
        else:
            showinfo("Incorrect Input", "You have voted incorrectly please try again")

    def go_back(self):
        self.list = root.place_slaves()
        for l in self.list:
            l.destroy()
        self.third_window = ThirdWindow(self.master)


class FacultyWindowSB:

    def __init__(self, master):
        self.master = master

        # Main Headers
        self.faculty_label = tk.Label(text="GSU Faculty Officers", bg="white",
                                      fg="black", width="40", height="1", font=("Georgia", "32", "bold", "italic"))
        self.faculty_label.place(relx=0.5, rely=0.10, anchor="center")

        self.faculty_two_label = tk.Label(text="Please rank each candidate in order of preference",
                                          bg="white",
                                          fg="black", width="40", height="1", font=("Georgia", "22", "bold", "italic"))
        self.faculty_two_label.place(relx=0.5, rely=0.2, anchor="center")

        self.unique_label = tk.Label(text="School of Business", bg="white",
                                     width="25", height="1", fg="black", font=("Georgia", "18", "bold"))
        self.unique_label.place(relx=0.488, rely=0.88, anchor="center")

        # Logo candidate
        self.logoGUI = Image.open("userLogo2.png")
        self.logorender1 = ImageTk.PhotoImage(self.logoGUI)
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.15, rely=0.35, anchor="center")
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.375, rely=0.35, anchor="center")
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.625, rely=0.35, anchor="center")
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.848, rely=0.35, anchor="center")

        # All combo boxes
        self.first_box = ttk.Combobox(values=sb_faculty_names, state="readonly")
        self.first_box.place(relx=0.15, rely=0.55, anchor="center")
        self.second_box = ttk.Combobox(values=sb_faculty_names, state="readonly")
        self.second_box.place(relx=0.375, rely=0.55, anchor="center")
        self.third_box = ttk.Combobox(values=sb_faculty_names, state="readonly")
        self.third_box.place(relx=0.625, rely=0.55, anchor="center")
        self.fourth_box = ttk.Combobox(values=sb_faculty_names, state="readonly")
        self.fourth_box.place(relx=0.85, rely=0.55, anchor="center")

        # Preference labels
        self.first_label = tk.Label(text="1st Preference", bg="RoyalBlue4", width="12",
                                    height="2", fg="white", font=("Georgia", "12", "bold"))
        self.first_label.place(relx=0.15, rely=0.50, anchor="center")
        self.second_label = tk.Label(text="2nd Preference", bg="RoyalBlue4", width="12",
                                     height="2", fg="white", font=("Georgia", "12", "bold"))
        self.second_label.place(relx=0.375, rely=0.50, anchor="center")
        self.third_label = tk.Label(text="3rd Preference", bg="RoyalBlue4", width="12",
                                    height="2", fg="white", font=("Georgia", "12", "bold"))
        self.third_label.place(relx=0.625, rely=0.50, anchor="center")
        self.fourth_label = tk.Label(text="4th Preference", bg="RoyalBlue4", width="12",
                                     height="2", fg="white", font=("Georgia", "12", "bold"))
        self.fourth_label.place(relx=0.85, rely=0.50, anchor="center")

        # Buttons
        self.save_choice = tk.Button(text="Save Choice", font=("Gill Sans MT", "12", "bold"), height="2", width="15",
                                     command=self.save_choice)
        self.save_choice.place(relx=0.5, rely=0.75, anchor="center")
        self.back_button = tk.Button(text="Back", font=("Gill Sans MT", "12", "bold"), height="2", width="15",
                                     command=self.go_back)
        self.back_button.place(relx=0.15, rely=0.90, anchor="center")

        # logo GSU
        self.logo4 = Image.open("logogsu.png")
        self.logorender4 = ImageTk.PhotoImage(self.logo4)
        self.main_label2 = tk.Label(image=self.logorender4)
        self.main_label2.place(relx=0.85, rely=0.90, anchor="center")

    def save_choice(self):
        global student_username
        self.first_choice = self.first_box.get()
        self.second_choice = self.second_box.get()
        self.third_choice = self.third_box.get()
        self.fourth_choice = self.fourth_box.get()
        globals()["faculty_votes"] = 0

        # if user has voted for all four preferences correctly without errors then save entry and continue
        if (self.first_box.get() in sb_faculty_names and self.second_box.get() in sb_faculty_names and
                self.third_box.get() in sb_faculty_names and self.fourth_box.get() in sb_faculty_names):
            if (self.first_box.get() != self.second_box.get() and self.first_box.get() != self.third_box.get() and
                    self.first_box.get() != self.fourth_box.get() and self.second_box.get() != self.third_box.get() and
                    self.second_box.get() != self.fourth_box.get() and self.third_box.get() != self.fourth_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="SB", username=student_username, first_pref=self.first_choice,
                                 second_pref=self.second_choice, third_pref=self.third_choice,
                                 fourth_pref=self.fourth_choice)
                    self.go_back()

            # If user selects the same candidate twice
            elif (self.first_box.get() == self.second_box.get() or self.first_box.get() == self.third_box.get() or
                  self.first_box.get() == self.fourth_box.get() or self.second_box.get() == self.third_box.get() or
                  self.second_box.get() == self.fourth_box.get() or self.third_box.get() == self.fourth_box.get()):
                showinfo("window", "You cannot select the same candidate twice. Please try again")

        # if user only votes for first preference
        elif (self.first_box.get() in sb_faculty_names and self.second_box.get() == "" and self.third_box.get() == ""
              and self.fourth_box.get() == ""):
            self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choice")
            if self.msgbox == "yes":
                globals()["faculty_votes"] = 1
                faculty_main(faculty="SB", username=student_username, first_pref=self.first_choice)
                self.go_back()

        # if user votes for 1st and 2nd preference but not 3rd or 4th
        elif (self.first_box.get() in sb_faculty_names and self.second_box.get() in sb_faculty_names and
              self.third_box.get() == "" and self.fourth_box.get() == ""):
            if self.first_box.get() != self.second_box.get():
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    self.go_back()
                    faculty_main(faculty="SB", username=student_username, first_pref=self.first_choice,
                                 second_pref=self.second_choice)
                    self.go_back()

            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st and 3rd but not 2nd or 4th
        elif (self.first_box.get() in sb_faculty_names and self.second_box.get() == "" and
              self.third_box.get() in sb_faculty_names and self.fourth_box.get() == ""):
            if self.first_box.get() != self.third_box.get():
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="SB", username=student_username, first_pref=self.first_choice,
                                 third_pref=self.third_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st and 4th but not 2nd or 3rd
        elif (self.first_box.get() in sb_faculty_names and self.second_box.get() == "" and
              self.third_box.get() == "" and self.fourth_box.get() in sb_faculty_names):
            if self.first_box.get() != self.fourth_box.get():
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="SB", username=student_username, first_pref=self.first_choice,
                                 fourth_pref=self.fourth_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st, 3rd and 4th but not 2nd
        elif (self.first_box.get() in sb_faculty_names and self.second_box.get() == "" and
              self.third_box.get() in sb_faculty_names and self.fourth_box.get() in sb_faculty_names):
            if (self.first_box.get() != self.fourth_box.get() and self.first_box.get() != self.third_box.get() and
                    self.third_box.get() != self.fourth_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="SB", username=student_username, first_pref=self.first_choice,
                                 third_pref=self.third_choice, fourth_pref=self.fourth_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st, 2nd and 4th but not 3rd
        elif (self.first_box.get() in sb_faculty_names and self.second_box.get() in sb_faculty_names and
              self.third_box.get() == "" and self.fourth_box.get() in sb_faculty_names):
            if (self.first_box.get() != self.second_box.get() and self.first_box.get() != self.fourth_box.get() and
                    self.second_box.get() != self.fourth_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="SB", username=student_username, first_pref=self.first_choice,
                                 second_pref=self.second_choice, fourth_pref=self.fourth_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st, 2nd and 3rd but not 4th
        elif (self.first_box.get() in sb_faculty_names and self.second_box.get() in sb_faculty_names and
              self.third_box.get() in sb_faculty_names and self.fourth_box.get() == ""):
            if (self.first_box.get() != self.second_box.get() and self.first_box.get() != self.third_box.get() and
                    self.second_box.get() != self.third_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["faculty_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    faculty_main(faculty="SB", username=student_username, first_pref=self.first_choice,
                                 second_pref=self.second_choice, third_pref=self.third_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # Incorrect voting
        else:
            showinfo("Incorrect Input", "You have voted incorrectly please try again")

    def go_back(self):
        self.list = root.place_slaves()
        for l in self.list:
            l.destroy()
        self.third_window = ThirdWindow(self.master)


class OfficerWindow:

    def __init__(self, master):
        self.master = master

        # Main Headers
        self.officer_label = tk.Label(text="GSU Officers", bg="white",
                                      fg="black", width="40", height="1", font=("Georgia", "32", "bold", "italic"))
        self.officer_label.place(relx=0.5, rely=0.10, anchor="center")

        self.officer_two_label = tk.Label(text="Please rank each candidate in order of preference",
                                          bg="white",
                                          fg="black", width="40", height="1", font=("Georgia", "22", "bold", "italic"))
        self.officer_two_label.place(relx=0.5, rely=0.2, anchor="center")

        # Logo candidate
        self.logoGUI = Image.open("userLogo2.png")
        self.logorender1 = ImageTk.PhotoImage(self.logoGUI)
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.15, rely=0.35, anchor="center")
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.375, rely=0.35, anchor="center")
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.625, rely=0.35, anchor="center")
        self.main_label2 = tk.Label(image=self.logorender1)
        self.main_label2.place(relx=0.848, rely=0.35, anchor="center")

        # All combo boxes

        self.first_box = ttk.Combobox(values=officer_names, state="readonly")
        self.first_box.place(relx=0.15, rely=0.55, anchor="center")
        self.second_box = ttk.Combobox(values=officer_names, state="readonly")
        self.second_box.place(relx=0.375, rely=0.55, anchor="center")
        self.third_box = ttk.Combobox(values=officer_names, state="readonly")
        self.third_box.place(relx=0.625, rely=0.55, anchor="center")
        self.fourth_box = ttk.Combobox(values=officer_names, state="readonly")
        self.fourth_box.place(relx=0.85, rely=0.55, anchor="center")

        # Preference labels
        self.first_label = tk.Label(text="1st Preference", bg="RoyalBlue4", width="12",
                                    height="2", fg="white", font=("Georgia", "11", "bold"))
        self.first_label.place(relx=0.15, rely=0.50, anchor="center")
        self.second_label = tk.Label(text="2nd Preference", bg="RoyalBlue4", width="12",
                                     height="2", fg="white", font=("Georgia", "11", "bold"))
        self.second_label.place(relx=0.375, rely=0.50, anchor="center")
        self.third_label = tk.Label(text="3rd Preference", bg="RoyalBlue4", width="12",
                                    height="2", fg="white", font=("Georgia", 11, "bold"))
        self.third_label.place(relx=0.625, rely=0.50, anchor="center")
        self.fourth_label = tk.Label(text="4th Preference", bg="RoyalBlue4", width="12",
                                     height="2", fg="white", font=("Georgia", "11", "bold"))
        self.fourth_label.place(relx=0.85, rely=0.50, anchor="center")

        # Buttons
        self.save_choice = tk.Button(text="Save Choice", font=("Gill Sans MT", "12", "bold"), height="2", width="15",
                                     command=self.save_choice)
        self.save_choice.place(relx=0.5, rely=0.75, anchor="center")
        self.back_button = tk.Button(text="Back", font=("Gill Sans MT", "12", "bold"), height="2", width="15",
                                     command=self.go_back)
        self.back_button.place(relx=0.15, rely=0.90, anchor="center")

        # logo GSU
        self.logo4 = Image.open("logogsu.png")
        self.logorender4 = ImageTk.PhotoImage(self.logo4)
        self.main_label2 = tk.Label(image=self.logorender4)
        self.main_label2.place(relx=0.85, rely=0.90, anchor="center")

    def save_choice(self):
        global student_username
        self.first_choice = self.first_box.get()
        self.second_choice = self.second_box.get()
        self.third_choice = self.third_box.get()
        self.fourth_choice = self.fourth_box.get()
        globals()["officer_votes"] = 0

        # if user has voted for all four preferences correctly without errors then save entry and continue
        if (self.first_box.get() in officer_names and self.second_box.get() in officer_names and
                self.third_box.get() in officer_names and self.fourth_box.get() in officer_names):
            if (self.first_box.get() != self.second_box.get() and self.first_box.get() != self.third_box.get() and
                    self.first_box.get() != self.fourth_box.get() and self.second_box.get() != self.third_box.get() and
                    self.second_box.get() != self.fourth_box.get() and self.third_box.get() != self.fourth_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["officer_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    officer_main(username=student_username, first_pref=self.first_choice,
                                 second_pref=self.second_choice, third_pref=self.third_choice,
                                 fourth_pref=self.fourth_choice)
                    self.go_back()

            # If user selects the same candidate twice
            elif (self.first_box.get() == self.second_box.get() or self.first_box.get() == self.third_box.get() or
                  self.first_box.get() == self.fourth_box.get() or self.second_box.get() == self.third_box.get() or
                  self.second_box.get() == self.fourth_box.get() or self.third_box.get() == self.fourth_box.get()):
                showinfo("window", "You cannot select the same candidate twice. Please try again")

        # if user only votes for first preference
        elif (self.first_box.get() in officer_names and self.second_box.get() == "" and self.third_box.get() == ""
              and self.fourth_box.get() == ""):
            self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choice")
            if self.msgbox == "yes":
                globals()["officer_votes"] = 1
                officer_main(username=student_username, first_pref=self.first_choice)
                self.go_back()

        # if user votes for 1st and 2nd preference but not 3rd or 4th
        elif (self.first_box.get() in officer_names and self.second_box.get() in officer_names and
              self.third_box.get() == "" and self.fourth_box.get() == ""):
            if self.first_box.get() != self.second_box.get():
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["officer_votes"] = 1
                    officer_main(username=student_username, first_pref=self.first_choice,
                                 second_pref=self.second_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st and 3rd but not 2nd or 4th
        elif (self.first_box.get() in officer_names and self.second_box.get() == "" and
              self.third_box.get() in officer_names and self.fourth_box.get() == ""):
            if self.first_box.get() != self.third_box.get():
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["officer_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    officer_main(username=student_username, first_pref=self.first_choice,
                                 third_pref=self.third_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st and 4th but not 2nd or 3rd
        elif (self.first_box.get() in officer_names and self.second_box.get() == "" and
              self.third_box.get() == "" and self.fourth_box.get() in officer_names):
            if self.first_box.get() != self.fourth_box.get():
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["officer_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    officer_main(username=student_username, first_pref=self.first_choice,
                                 fourth_pref=self.fourth_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st, 3rd and 4th but not 2nd
        elif (self.first_box.get() in officer_names and self.second_box.get() == "" and
              self.third_box.get() in officer_names and self.fourth_box.get() in officer_names):
            if (self.first_box.get() != self.fourth_box.get() and self.first_box.get() != self.third_box.get() and
                    self.third_box.get() != self.fourth_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["officer_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    officer_main(username=student_username, first_pref=self.first_choice,
                                 third_pref=self.third_choice, fourth_pref=self.fourth_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st, 2nd and 4th but not 3rd
        elif (self.first_box.get() in officer_names and self.second_box.get() in officer_names and
              self.third_box.get() == "" and self.fourth_box.get() in officer_names):
            if (self.first_box.get() != self.second_box.get() and self.first_box.get() != self.fourth_box.get() and
                    self.second_box.get() != self.fourth_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["officer_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    officer_main(username=student_username, first_pref=self.first_choice,
                                 second_pref=self.second_choice, fourth_pref=self.fourth_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # if user votes for 1st, 2nd and 3rd but not 4th
        elif (self.first_box.get() in officer_names and self.second_box.get() in officer_names and
              self.third_box.get() in officer_names and self.fourth_box.get() == ""):
            if (self.first_box.get() != self.second_box.get() and self.first_box.get() != self.third_box.get() and
                    self.second_box.get() != self.third_box.get()):
                self.msgbox = tk.messagebox.askquestion("Save & Exit", "Please confirm you are happy with your choices")
                if self.msgbox == "yes":
                    globals()["officer_votes"] = 1
                    # SQLite Query that saves choices straight into relevant table
                    officer_main(username=student_username, first_pref=self.first_choice,
                                 second_pref=self.second_choice, third_pref=self.third_choice)
                    self.go_back()
            else:
                showinfo("Incorrect Input", "You have voted incorrectly. Please try again")

        # Incorrect voting
        else:
            showinfo("Incorrect Input", "You have voted incorrectly please try again")
            
    def go_back(self):
        self.list = root.place_slaves()
        for l in self.list:
            l.destroy()
        self.third_window = ThirdWindow(self.master)


if __name__ == '__main__':
    root = tk.Tk()
    app = MainWindow(root)
    root.mainloop()
